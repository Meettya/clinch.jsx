// Generated by CoffeeScript 1.10.0

/*
This is separate React jsx addon for Clinch processor
 */

(function() {
  var babel, builder, extend, extension, get_options, preset_es2015, preset_react, processor;

  extend = require('whet.extend');

  babel = require('babel-core');

  preset_react = require('babel-preset-react');

  preset_es2015 = require('babel-preset-es2015');

  extension = '.jsx';

  get_options = function(filename, is_es2015_used) {
    var presets;
    presets = is_es2015_used ? [preset_react, preset_es2015] : [preset_react];
    return {
      ast: false,
      presets: presets,
      filename: filename
    };
  };

  builder = function(raw_options) {
    var currnet_extention, use_es2015;
    if (raw_options == null) {
      raw_options = {};
    }
    use_es2015 = false;
    if (raw_options.es2015 != null) {
      use_es2015 = raw_options.es2015;
      delete raw_options.es2015;
    }
    currnet_extention = extension;
    if (raw_options.extension != null) {
      currnet_extention = raw_options.extension;
      delete raw_options.extension;
    }
    return {
      extension: currnet_extention,
      processor: function(data, filename, cb) {
        var error, error1, options, result;
        options = extend({}, raw_options, get_options(filename, use_es2015));
        try {
          result = babel.transform(data, options);
        } catch (error1) {
          error = error1;
          error.filename = filename;
          return cb(error);
        }
        return cb(null, result.code, true);
      }
    };
  };

  processor = function(data, filename, cb) {
    return builder().processor(data, filename, cb);
  };

  builder.extension = extension;

  builder.processor = processor;

  module.exports = builder;

}).call(this);
